>>> from psil import read, eval, psil

>>> eval(read("(+ 1 2 3 4)"))
10

>>> eval(read("(define my-age 9)"))
9
>>> eval(read("my-age"))
9
>>> eval(read("(set! my-age 10)"))
10
>>> eval(read("my-age"))
10

>>> eval(read("9"))
9
>>> eval(read("10"))
10
>>> eval(read("my-age"))
10
>>> eval(read("#t"))
T
>>> eval(read("#f"))
F
>>> eval(read("()"))
[]
>>> eval(read("your-age"))
Traceback (most recent call last):
    ...
UndefinedSymbolError: your-age

>>> eval(read("(+ 2 13 45)"))
60
>>> eval(read("(+ my-age 1)"))
11
>>> eval(read("(+ your-age 1)"))
Traceback (most recent call last):
    ...
UndefinedSymbolError: your-age
>>> eval(read("(foo 1 3 4)"))
Traceback (most recent call last):
    ...
UndefinedSymbolError: foo

>>> eval(read("(+ 1 2)"))
3
>>> eval(read("(- 9 5)"))
4
>>> eval(read("(* 3 4 5)"))
60
>>> eval(read("(/ 15 3)"))
5

>>> eval(read("(cons 1 ())"))
[1]
>>> eval(read("(cons 1 (cons 2 ()))"))
[1, 2]

>>> eval(read("'a"))
<a>
>>> eval(read("(cons 'a '(b c d))"))
[<a>, <b>, <c>, <d>]
>>> eval(read("(list 2 3 4)"))
[2, 3, 4]
>>> eval(read("(list 'a '(a s d f))"))
[<a>, [<a>, <s>, <d>, <f>]]
>>> eval(read("(append '(a b) '(c d))"))
[<a>, <b>, <c>, <d>]

>>> eval(read("(first '(a s d f))"))
<a>
>>> eval(read("(first '((a s) d f))"))
[<a>, <s>]
>>> eval(read("(rest '(a s d f))"))
[<s>, <d>, <f>]
>>> eval(read("(rest '((a s) d f))"))
[<d>, <f>]
>>> eval(read("(rest '((a s) (d f)))"))
[[<d>, <f>]]
>>> eval(read("(define a ())"))
[]
>>> eval(read("(set! a '(a s d f))"))
[<a>, <s>, <d>, <f>]
>>> eval(read("(first a)"))
<a>
>>> eval(read("(rest a)"))
[<s>, <d>, <f>]
>>> eval(read("(first (rest a))"))
<s>

>>> eval(read("(cons 'a a)"))
[<a>, <a>, <s>, <d>, <f>]
>>> eval(read("a"))
[<a>, <s>, <d>, <f>]
>>> eval(read("(set! a (cons 'a a))"))
[<a>, <a>, <s>, <d>, <f>]
>>> eval(read("a"))
[<a>, <a>, <s>, <d>, <f>]

>>> eval(read("(length '(1 2 3))"))
3
>>> eval(read("(length a)"))
5
>>> eval(read("(length (append a a))"))
10
>>> eval(read("(length '(append a a))"))
3
>>> eval(read("(length (list a a))"))
2

>>> eval(read("(list? 'a)"))
F
>>> eval(read("(list? a)"))
T

>>> eval(read("(set! my-age (+ my-age 1))"))
11
>>> eval(read("(set! a (cdr a))"))
[<a>, <s>, <d>, <f>]
>>> eval(read("(define words ())"))
[]
>>> eval(read("(set! words '(a list of words))"))
[<a>, <list>, <of>, <words>]
>>> eval(read("(set! words (cons 'this (rest words)))"))
[<this>, <list>, <of>, <words>]

#>>> eval(read("(setf (first words) 'the)"))
#<the>
#>>> eval(read("words"))
#[<the>, <list>, <of>, <words>]
#>>> eval(read("(setf (third words) 'is)"))
#<is>
#>>> eval(read("words"))
#[<the>, <list>, <is>, <words>]
#>>> eval(read("(setf (rest words) '(game is up))"))
#[<game>, <is>, <up>]
#>>> eval(read("words"))
#[<the>, <game>, <is>, <up>]

>>> eval(read("(define (square x) (* x x))")) #doctest: +ELLIPSIS
<psil.Function object at 0x...>
>>> eval(read("(square 2)"))
4
>>> eval(read("(square 1.4142158)"))
2.0000063289696399

>>> eval(read("(define x 3)"))
3
>>> eval(read("(square 345)"))
119025
>>> eval(read("x"))
3
>>> eval(read("(define (y-plus x) (+ x y))")) #doctest: +ELLIPSIS
<psil.Function object at 0x...>
>>> eval(read("(define y 0)"))
0
>>> eval(read("(set! y 2)"))
2
>>> eval(read("(y-plus 4)"))
6
>>> eval(read("(set! x 5)"))
5
>>> eval(read("(y-plus 23)"))
25
>>> eval(read("x"))
5
>>> eval(read("(set! y 27)"))
27
>>> eval(read("(y-plus 43)"))
70

>>> eval(read("(define (fourth-power x) (square (square x)))")) #doctest: +ELLIPSIS
<psil.Function object at 0x...>
>>> eval(read("(fourth-power 2)"))
16

>>> eval(read("""(define (powers-of x)
...   (square x)
...      (fourth-power x))""")) #doctest: +ELLIPSIS
<psil.Function object at 0x...>
>>> eval(read("(powers-of 2)"))
16
>>> eval(read("""(define (powers-of x)
...   (set! y (square x))
...   (fourth-power x))""")) #doctest: +ELLIPSIS
<psil.Function object at 0x...>
>>> eval(read("y"))
27
>>> eval(read("(powers-of 7)"))
2401
>>> eval(read("y"))
49

>>> eval(read("""(define (absdiff x y)
...  (if (> x y)
...      (- x y)
...      (- y x)))""")) #doctest: +ELLIPSIS
<psil.Function object at 0x...>
>>> eval(read("(absdiff 3 4)"))
1
>>> eval(read("(absdiff 4 3)"))
1

>>> psil("(define a 1) (define b 2) (define c 3)")
3
>>> psil("`,a")
1
>>> psil("`(a ,b c)")
[<a>, 2, <c>]
>>> psil("`(a (,b c))")
[<a>, [2, <c>]]
>>> psil("`(a b ,c (',(+ a b c)) (+ a b) 'c '((,a ,b)))")
[<a>, <b>, 3, [[<quote>, 6]], [<+>, <a>, <b>], [<quote>, <c>], [<quote>, [[1, 2]]]]

>>> psil("(defmacro one! (var) `(set! ,var 1))") #doctest: +ELLIPSIS
<psil.Macro object at 0x...>
>>> psil("(one! b)")
1
>>> psil("b")
1
